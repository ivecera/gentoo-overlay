From f3eb99eade0c959f1784466081f995919003c02b Mon Sep 17 00:00:00 2001
From: Root <root@cera.cz>
Date: Mon, 14 Nov 2016 14:54:05 +0100
Subject: [PATCH 2/3] rename DO_ONCE to VMW_DO_ONCE

---
 vmblock-only/shared/vm_assert.h     | 4 ++--
 vmblock-only/shared/vm_basic_defs.h | 2 +-
 vmci-only/shared/vm_assert.h        | 4 ++--
 vmci-only/shared/vm_basic_defs.h    | 2 +-
 vmmon-only/include/vm_assert.h      | 4 ++--
 vmmon-only/include/vm_basic_defs.h  | 2 +-
 vmnet-only/vm_assert.h              | 4 ++--
 vmnet-only/vm_basic_defs.h          | 2 +-
 vsock-only/shared/vm_assert.h       | 4 ++--
 vsock-only/shared/vm_basic_defs.h   | 2 +-
 10 files changed, 15 insertions(+), 15 deletions(-)

diff --git a/vmblock-only/shared/vm_assert.h b/vmblock-only/shared/vm_assert.h
index b368e1d..b6958de 100644
--- a/vmblock-only/shared/vm_assert.h
+++ b/vmblock-only/shared/vm_assert.h
@@ -213,7 +213,7 @@ void WarningThrottled(uint32 *count, const char *fmt, ...) PRINTF_DECL(2, 3);
 #define ASSERT_HAS_INTERRUPTS() ASSERT(INTERRUPTS_ENABLED())
 
 #define ASSERT_NOT_TESTED(cond) (UNLIKELY(!(cond)) ? NOT_TESTED() : (void)0)
-#define NOT_TESTED_ONCE()       DO_ONCE(NOT_TESTED())
+#define NOT_TESTED_ONCE()       VMW_DO_ONCE(NOT_TESTED())
 
 #define NOT_TESTED_1024()                                               \
    do {                                                                 \
@@ -222,7 +222,7 @@ void WarningThrottled(uint32 *count, const char *fmt, ...) PRINTF_DECL(2, 3);
       count = (count + 1) & 1023;                                       \
    } while (0)
 
-#define LOG_ONCE(_s) DO_ONCE(Log _s)
+#define LOG_ONCE(_s) VMW_DO_ONCE(Log _s)
 
 
 /*
diff --git a/vmblock-only/shared/vm_basic_defs.h b/vmblock-only/shared/vm_basic_defs.h
index efe492a..cff214f 100644
--- a/vmblock-only/shared/vm_basic_defs.h
+++ b/vmblock-only/shared/vm_basic_defs.h
@@ -720,7 +720,7 @@ typedef int pid_t;
                                                      lfMessageFont)
 
 /* This is not intended to be thread-safe. */
-#define DO_ONCE(code)                                                   \
+#define VMW_DO_ONCE(code)                                                   \
    do {                                                                 \
       static Bool _doOnceDone = FALSE;                                  \
       if (UNLIKELY(!_doOnceDone)) {                                     \
diff --git a/vmci-only/shared/vm_assert.h b/vmci-only/shared/vm_assert.h
index b368e1d..b6958de 100644
--- a/vmci-only/shared/vm_assert.h
+++ b/vmci-only/shared/vm_assert.h
@@ -213,7 +213,7 @@ void WarningThrottled(uint32 *count, const char *fmt, ...) PRINTF_DECL(2, 3);
 #define ASSERT_HAS_INTERRUPTS() ASSERT(INTERRUPTS_ENABLED())
 
 #define ASSERT_NOT_TESTED(cond) (UNLIKELY(!(cond)) ? NOT_TESTED() : (void)0)
-#define NOT_TESTED_ONCE()       DO_ONCE(NOT_TESTED())
+#define NOT_TESTED_ONCE()       VMW_DO_ONCE(NOT_TESTED())
 
 #define NOT_TESTED_1024()                                               \
    do {                                                                 \
@@ -222,7 +222,7 @@ void WarningThrottled(uint32 *count, const char *fmt, ...) PRINTF_DECL(2, 3);
       count = (count + 1) & 1023;                                       \
    } while (0)
 
-#define LOG_ONCE(_s) DO_ONCE(Log _s)
+#define LOG_ONCE(_s) VMW_DO_ONCE(Log _s)
 
 
 /*
diff --git a/vmci-only/shared/vm_basic_defs.h b/vmci-only/shared/vm_basic_defs.h
index efe492a..cff214f 100644
--- a/vmci-only/shared/vm_basic_defs.h
+++ b/vmci-only/shared/vm_basic_defs.h
@@ -720,7 +720,7 @@ typedef int pid_t;
                                                      lfMessageFont)
 
 /* This is not intended to be thread-safe. */
-#define DO_ONCE(code)                                                   \
+#define VMW_DO_ONCE(code)                                                   \
    do {                                                                 \
       static Bool _doOnceDone = FALSE;                                  \
       if (UNLIKELY(!_doOnceDone)) {                                     \
diff --git a/vmmon-only/include/vm_assert.h b/vmmon-only/include/vm_assert.h
index b368e1d..b6958de 100644
--- a/vmmon-only/include/vm_assert.h
+++ b/vmmon-only/include/vm_assert.h
@@ -213,7 +213,7 @@ void WarningThrottled(uint32 *count, const char *fmt, ...) PRINTF_DECL(2, 3);
 #define ASSERT_HAS_INTERRUPTS() ASSERT(INTERRUPTS_ENABLED())
 
 #define ASSERT_NOT_TESTED(cond) (UNLIKELY(!(cond)) ? NOT_TESTED() : (void)0)
-#define NOT_TESTED_ONCE()       DO_ONCE(NOT_TESTED())
+#define NOT_TESTED_ONCE()       VMW_DO_ONCE(NOT_TESTED())
 
 #define NOT_TESTED_1024()                                               \
    do {                                                                 \
@@ -222,7 +222,7 @@ void WarningThrottled(uint32 *count, const char *fmt, ...) PRINTF_DECL(2, 3);
       count = (count + 1) & 1023;                                       \
    } while (0)
 
-#define LOG_ONCE(_s) DO_ONCE(Log _s)
+#define LOG_ONCE(_s) VMW_DO_ONCE(Log _s)
 
 
 /*
diff --git a/vmmon-only/include/vm_basic_defs.h b/vmmon-only/include/vm_basic_defs.h
index efe492a..cff214f 100644
--- a/vmmon-only/include/vm_basic_defs.h
+++ b/vmmon-only/include/vm_basic_defs.h
@@ -720,7 +720,7 @@ typedef int pid_t;
                                                      lfMessageFont)
 
 /* This is not intended to be thread-safe. */
-#define DO_ONCE(code)                                                   \
+#define VMW_DO_ONCE(code)                                                   \
    do {                                                                 \
       static Bool _doOnceDone = FALSE;                                  \
       if (UNLIKELY(!_doOnceDone)) {                                     \
diff --git a/vmnet-only/vm_assert.h b/vmnet-only/vm_assert.h
index b368e1d..b6958de 100644
--- a/vmnet-only/vm_assert.h
+++ b/vmnet-only/vm_assert.h
@@ -213,7 +213,7 @@ void WarningThrottled(uint32 *count, const char *fmt, ...) PRINTF_DECL(2, 3);
 #define ASSERT_HAS_INTERRUPTS() ASSERT(INTERRUPTS_ENABLED())
 
 #define ASSERT_NOT_TESTED(cond) (UNLIKELY(!(cond)) ? NOT_TESTED() : (void)0)
-#define NOT_TESTED_ONCE()       DO_ONCE(NOT_TESTED())
+#define NOT_TESTED_ONCE()       VMW_DO_ONCE(NOT_TESTED())
 
 #define NOT_TESTED_1024()                                               \
    do {                                                                 \
@@ -222,7 +222,7 @@ void WarningThrottled(uint32 *count, const char *fmt, ...) PRINTF_DECL(2, 3);
       count = (count + 1) & 1023;                                       \
    } while (0)
 
-#define LOG_ONCE(_s) DO_ONCE(Log _s)
+#define LOG_ONCE(_s) VMW_DO_ONCE(Log _s)
 
 
 /*
diff --git a/vmnet-only/vm_basic_defs.h b/vmnet-only/vm_basic_defs.h
index efe492a..cff214f 100644
--- a/vmnet-only/vm_basic_defs.h
+++ b/vmnet-only/vm_basic_defs.h
@@ -720,7 +720,7 @@ typedef int pid_t;
                                                      lfMessageFont)
 
 /* This is not intended to be thread-safe. */
-#define DO_ONCE(code)                                                   \
+#define VMW_DO_ONCE(code)                                                   \
    do {                                                                 \
       static Bool _doOnceDone = FALSE;                                  \
       if (UNLIKELY(!_doOnceDone)) {                                     \
diff --git a/vsock-only/shared/vm_assert.h b/vsock-only/shared/vm_assert.h
index b368e1d..b6958de 100644
--- a/vsock-only/shared/vm_assert.h
+++ b/vsock-only/shared/vm_assert.h
@@ -213,7 +213,7 @@ void WarningThrottled(uint32 *count, const char *fmt, ...) PRINTF_DECL(2, 3);
 #define ASSERT_HAS_INTERRUPTS() ASSERT(INTERRUPTS_ENABLED())
 
 #define ASSERT_NOT_TESTED(cond) (UNLIKELY(!(cond)) ? NOT_TESTED() : (void)0)
-#define NOT_TESTED_ONCE()       DO_ONCE(NOT_TESTED())
+#define NOT_TESTED_ONCE()       VMW_DO_ONCE(NOT_TESTED())
 
 #define NOT_TESTED_1024()                                               \
    do {                                                                 \
@@ -222,7 +222,7 @@ void WarningThrottled(uint32 *count, const char *fmt, ...) PRINTF_DECL(2, 3);
       count = (count + 1) & 1023;                                       \
    } while (0)
 
-#define LOG_ONCE(_s) DO_ONCE(Log _s)
+#define LOG_ONCE(_s) VMW_DO_ONCE(Log _s)
 
 
 /*
diff --git a/vsock-only/shared/vm_basic_defs.h b/vsock-only/shared/vm_basic_defs.h
index efe492a..cff214f 100644
--- a/vsock-only/shared/vm_basic_defs.h
+++ b/vsock-only/shared/vm_basic_defs.h
@@ -720,7 +720,7 @@ typedef int pid_t;
                                                      lfMessageFont)
 
 /* This is not intended to be thread-safe. */
-#define DO_ONCE(code)                                                   \
+#define VMW_DO_ONCE(code)                                                   \
    do {                                                                 \
       static Bool _doOnceDone = FALSE;                                  \
       if (UNLIKELY(!_doOnceDone)) {                                     \
-- 
2.7.3

